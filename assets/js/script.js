// Generated by CoffeeScript 1.3.3
/*
Do NOT modify .js file, modify only the .coffee file 
This script is used for data validation, and ajax.
This script is NOT for UI, or animation, do that in global-script instead.
*/

$(document).ready(function() {
  var bidOfferValidator, confirmMsg, displayError, loginValidator, noteAlert, noteConfirm, postOfferValidator;
  $('.tiptip a.button, .tiptip button').tipTip();
  noteAlert = function(msg, type) {
    var n;
    return n = noty({
      layout: 'bottomRight',
      type: type,
      text: msg,
      animation: {
        open: {
          height: 'toggle'
        },
        close: {
          height: 'toggle'
        },
        easing: 'swing',
        speed: 200
      },
      timeout: 5000
    });
  };
  noteConfirm = function(msg, url) {
    var n;
    return n = noty({
      layout: 'center',
      type: 'alert',
      text: msg,
      modal: true,
      animation: {
        open: {
          height: 'toggle'
        },
        close: {
          height: 'toggle'
        },
        easing: 'swing',
        speed: 50
      },
      buttons: [
        {
          addClass: 'btn btn-primary',
          text: 'Continue',
          onClick: function($noty) {
            $noty.close();
            return window.location = url;
          }
        }, {
          addClass: 'btn btn-danger',
          text: 'Cancel',
          onClick: function($noty) {
            return $noty.close();
          }
        }
      ]
    });
  };
  $(".delete, .confirm").live('click', function() {
    this.blur();
    return false;
  });
  $('.delete').click(function() {
    var loc;
    loc = $(this).attr("href");
    return noteConfirm("Are you sure you want to perform a delete?", loc);
  });
  $('.confirm').click(function() {
    var loc;
    loc = $(this).attr("href");
    return noteConfirm("Are you sure you want to accept this offer?", loc);
  });
  displayError = function(errors, event, confirmMsg) {
    var error, errorString, _i, _len, _results;
    if (confirmMsg == null) {
      confirmMsg = "Proceed to submit?";
    }
    if (errors.length > 0) {
      errorString = "";
      _results = [];
      for (_i = 0, _len = errors.length; _i < _len; _i++) {
        error = errors[_i];
        _results.push(noteAlert(error.message, "warning"));
      }
      return _results;
    } else {
      if (confirmMsg != null) {
        if (confirm(confirmMsg)) {
          return true;
        } else {
          return false;
        }
      }
    }
  };
  /*
      Login Form Validator
  */

  confirmMsg = "Proceed to sign in?";
  loginValidator = new FormValidator("login-form", [
    {
      name: 'username',
      rules: 'required|max_length[30]'
    }, {
      name: 'password',
      rules: 'required'
    }
  ], displayError);
  /*
      Post Offer Form Validator
  */

  postOfferValidator = new FormValidator("post-offer-form", [
    {
      name: "title",
      rules: "required|max_length[50]"
    }, {
      name: "category",
      rules: "required"
    }, {
      name: "price",
      rules: "required|numeric"
    }, {
      name: "description",
      rules: "required"
    }
  ], displayError);
  /*
      Bid On Offer Form Validator
  */

  return bidOfferValidator = new FormValidator("bid-offer-form", [
    {
      name: "category",
      rules: "required"
    }, {
      name: "price",
      rules: "required|numeric"
    }, {
      name: "description",
      rules: "required|max_length[100]"
    }
  ], displayError);
});
