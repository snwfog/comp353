{% extends 'static/base.twig' %}

{% block content %}
    <h1>Public Standing</h1>
    <h3>Rating</h3>
    {% if avg_rating %}
        <h1>{{ avg_rating }}</h1>
    {% else %}
        <h1>No rating</h1>
    {% endif %}

    <h3>Comments</h3>
    {% if comments %}
        <table name="comment-table">
            <tr>
                <th>User
                <th>Rating
                <th>Comment
            </tr>
            {% for comment in comments %}
                <tr>
                    <td>
                        <a href="index.php?member&id={{ comment.rater_id }}">
                            {{ comment.rater }}
                        </a>
                    <td>{{ comment.rating }}</a>
                    <td>{{ comment.comment }}</a>
                </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>This person currently has no comment, or has not made
        any transaction.</p>
    {% endif %}


    {#{% if not is_owner and is_transact %}#}
    {% if not is_owner %}
        <hr />
        <form action="index.php?member&id={{ id }}" method="POST">
            <ul>
                <li><select name="rating">
                    {% for value in 1..10 %}
                        <option value="{{ value }}">{{ value }}</option>
                    {% endfor %}
                </select>
                <li><textarea type="text" name="comment" cols="30" rows="6"></textarea>
                <li><input type="hidden" name="ratee_id" value={{ id }}></li>
                <li><input type="hidden" name="feedback" value="TRUE" />
                <li><input type="submit" value="Rate" />
            </ul>
        </form>
    {% endif %}

    <h1>Information</h1>
    <h3>{{ username }}</h3>
    <img src="{{ avatar_url }}" alt="{{ username }}" />

    <hr /><h1>Offers</h1>
    {% if offers %}
        <table name="offer-table">
        <tr>
            <th>View
            <th>Type
            <th>Category
            <th>Title
            <th>Price
            <th>Delete
        </tr>
        {% for offer in offers %}
            {% if(offer.expire == 0)%}
                  <tr>
                      <td><a href="index.php?offer&id={{ offer.id }}">View</a>
                      <td><a href="#">{{ offer.type }}</a>
                      <td><a href="#">{{ offer.category }}</a>
                      <td>{{ offer.title }}
                      <td>$ {{ offer.price|number_format('2', '.', ' ') }}
                      <td><form action="index.php?offer&delete={{ offer.id }}" method="POST">
                              <input type="submit" value="Delete Offer" />
                          </form>
                  </tr>
            {% endif %}
        {% endfor %}
        </table>
    {% elseif is_owner %}
        <p>You do not have any offers. Click <a href="index.php?post">here</a>
        to start a new offer.</p>
    {% else %}
        <p>This member currently has no ongoing offers.</p>
    {% endif %}

    {# Show bids only if it is private view mode #}
    {% if private %}
        <hr /><h1>Bids</h1>
        {% if bids %}
        {% else %}
            <p>You do not have any ongoing bids.</p>
        {% endif %}

    {% endif %}



    {% if private %}
        <hr /><h1>Transaction</h1>
        {% if solds %}
            <h2>SOLD</h2>
            <table name="sold-table">
            <tr>
                <th>Title
                <th>Price
                <th>Buyer
            </tr>
            {% for x in solds %}
                      <tr>
                          <td><a href="index.php?offer&id={{ x.offer_id }}">{{ x.title }}</a>
                          <td><a href="#">{{ x.price }}</a>
                          <td><a href="index.php?member&id={{x.buyer_id}}">{{ x.username }}</a>
                      </tr>
            {% endfor %}
            </table>
        {% endif %}


        {% if boughts %}
            <h2>SOLD</h2>
            <table name="bought-table">
            <tr>
                <th>Title
                <th>Price
                <th>Seller
            </tr>
            {% for x in boughts %}
                      <tr>
                          <td><a href="index.php?offer&id={{ x.offer_id }}">{{ x.title }}</a>
                          <td><a href="#">{{ x.price }}</a>
                          <td><a href="index.php?member&id={{x.seller_id}}">{{ x.username }}</a>
                      </tr>
            {% endfor %}
            </table>
        {% endif %}

    {% endif %}
{% endblock content %}